{
  "$defs": {
    "EncodingPatchOp": {
      "additionalProperties": false,
      "description": "单个编码补丁操作。",
      "properties": {
        "x-spec-version": {
          "default": "2.0.0",
          "description": "契约对象对应的 Schema 版本号，用于离线回放与迁移。",
          "title": "X-Spec-Version",
          "type": "string"
        },
        "op_type": {
          "description": "操作类型。",
          "enum": [
            "add",
            "remove",
            "replace"
          ],
          "title": "Op Type",
          "type": "string"
        },
        "path": {
          "description": "指向编码对象的路径，按层级拆分。",
          "items": {
            "type": "string"
          },
          "minItems": 1,
          "title": "Path",
          "type": "array"
        },
        "value": {
          "default": null,
          "description": "在 add/replace 操作中写入的具体值。",
          "title": "Value"
        }
      },
      "required": [
        "op_type",
        "path"
      ],
      "title": "EncodingPatchOp",
      "type": "object"
    }
  },
  "additionalProperties": false,
  "description": "针对 ChartSpec 的增量编码变更。",
  "properties": {
    "x-spec-version": {
      "default": "2.0.0",
      "description": "契约对象对应的 Schema 版本号，用于离线回放与迁移。",
      "title": "X-Spec-Version",
      "type": "string"
    },
    "target_chart_id": {
      "description": "需要应用补丁的图表 ID。",
      "minLength": 1,
      "title": "Target Chart Id",
      "type": "string"
    },
    "ops": {
      "description": "补丁操作集合，按顺序执行。",
      "items": {
        "$ref": "#/$defs/EncodingPatchOp"
      },
      "minItems": 1,
      "title": "Ops",
      "type": "array"
    },
    "rationale": {
      "description": "提出该补丁的原因说明。",
      "minLength": 1,
      "title": "Rationale",
      "type": "string"
    }
  },
  "required": [
    "target_chart_id",
    "ops",
    "rationale"
  ],
  "title": "EncodingPatch",
  "type": "object",
  "$id": "https://schemas.data-interface.local/contracts/encoding_patch.json",
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "version": "2.0.0"
}
