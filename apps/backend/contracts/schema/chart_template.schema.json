{
  "title": "ChartTemplate",
  "description": "图表模板契约。",
  "type": "object",
  "properties": {
    "template_id": {
      "title": "Template Id",
      "description": "模板唯一标识。",
      "minLength": 1,
      "type": "string"
    },
    "version": {
      "title": "Version",
      "description": "模板版本号。",
      "minLength": 1,
      "type": "string"
    },
    "name": {
      "title": "Name",
      "description": "模板名称。",
      "minLength": 1,
      "type": "string"
    },
    "description": {
      "title": "Description",
      "description": "模板说明，用于提示合适的使用场景。",
      "type": "string"
    },
    "mark": {
      "title": "Mark",
      "description": "对应的可视化基础图元类型。",
      "enum": [
        "bar",
        "line",
        "area",
        "point",
        "pie",
        "heatmap",
        "table",
        "boxplot"
      ],
      "type": "string"
    },
    "encodings": {
      "title": "Encodings",
      "description": "模板支持的编码通道集合。",
      "json_schema_extra": {
        "minItems": 1
      },
      "type": "array",
      "items": {
        "$ref": "#/definitions/ChartEncoding"
      }
    },
    "default_config": {
      "title": "Default Config",
      "description": "可直接传给渲染引擎的默认配置片段。",
      "type": "object"
    },
    "supported_engines": {
      "title": "Supported Engines",
      "description": "模板兼容的渲染引擎列表。",
      "json_schema_extra": {
        "minItems": 1
      },
      "type": "array",
      "items": {
        "enum": [
          "vega-lite",
          "echarts"
        ],
        "type": "string"
      }
    }
  },
  "required": [
    "template_id",
    "version",
    "name",
    "mark",
    "encodings",
    "supported_engines"
  ],
  "additionalProperties": false,
  "$defs": {
    "ChartEncoding": {
      "title": "ChartEncoding",
      "description": "可视化编码通道的契约描述。",
      "type": "object",
      "properties": {
        "channel": {
          "title": "Channel",
          "description": "编码通道名称。",
          "enum": [
            "x",
            "y",
            "color",
            "size",
            "theta",
            "radius",
            "row",
            "column",
            "tooltip",
            "detail"
          ],
          "type": "string"
        },
        "semantic_role": {
          "title": "Semantic Role",
          "description": "该编码通道期望绑定的字段语义。",
          "enum": [
            "dimension",
            "measure",
            "temporal",
            "identifier",
            "geo"
          ],
          "type": "string"
        },
        "required": {
          "title": "Required",
          "description": "通道是否为模板必填。",
          "type": "boolean"
        },
        "allow_multiple": {
          "title": "Allow Multiple",
          "description": "通道是否允许绑定多个字段。",
          "type": "boolean"
        },
        "aggregate": {
          "title": "Aggregate",
          "description": "默认聚合方式，仅对度量字段生效。",
          "enum": [
            "sum",
            "avg",
            "min",
            "max",
            "count",
            "median"
          ],
          "type": "string"
        },
        "description": {
          "title": "Description",
          "description": "通道的业务说明或使用建议。",
          "type": "string"
        }
      },
      "required": [
        "channel",
        "semantic_role",
        "required",
        "allow_multiple"
      ],
      "additionalProperties": false
    }
  },
  "$id": "https://schemas.data-interface.local/contracts/chart_template.json",
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "version": "1.0.0"
}